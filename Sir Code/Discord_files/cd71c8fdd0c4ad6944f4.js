(window.webpackJsonp=window.webpackJsonp||[]).push([[169],{1910:function(e,t,n){"use strict";t.__esModule=!0;var o,r=n(2100),c=(o=r)&&o.__esModule?o:{default:o};t.default=c.default,e.exports=t.default},2017:function(e,t,n){"use strict";t.__esModule=!0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=f(n(196)),c=f(n(423)),i=f(n(202)),u=n(5),s=f(n(1910)),a=f(n(59)),l=f(n(430));function f(e){return e&&e.__esModule?e:{default:e}}var d=u.RPC_STARTING_PORT+u.RPC_PORT_RANGE-1;function p(e,t){if(null==e||null==t)throw new Error("cmd and name required");return e+":"+t}var R=i.default.parse(location.search.slice(1)),h=parseInt(R.rpc||u.RPC_STARTING_PORT,10),v=void 0,m=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.connect=function(){var e=this;if(null==v){if(h>d)return h=u.RPC_STARTING_PORT,void this.emit("disconnected");try{v=new WebSocket("ws://127.0.0.1:"+this.port+"/?v="+u.RPC_VERSION)}catch(e){return void this.disconnect({code:u.RPCCloseCodes.CLOSE_ABNORMAL})}null!=v&&(v.onmessage=function(t){var n=void 0;try{if("string"!=typeof t.data)throw new Error("payload data not a string");n=JSON.parse(t.data)}catch(t){return e.emit("error",t),void e.disconnect()}var o=n,r=o.cmd,c=o.evt,i=o.nonce,a=o.data;if(r===u.RPCCommands.DISPATCH)return c===u.RPCEvents.READY?void e.emit("connected"):c===u.RPCEvents.ERROR?(e.emit("error",new s.default(a.code,a.message)),void e.disconnect()):void e.emit(p(r,c),a);var l=null;c===u.RPCEvents.ERROR&&(l=new s.default(a.code,a.message),a=null),e.emit(p(r,i),l,a)},v.onclose=v.onerror=function(t){return e.disconnect(t)})}},t.prototype.disconnect=function(e){if(null!=e&&null!=e.code&&[u.RPCCloseCodes.CLOSE_ABNORMAL,u.RPCCloseCodes.INVALID_CLIENTID].includes(e.code))return h++,v=null,void this.connect();null!=v&&(this.emit("disconnected"),v.close(),v=null)},t.prototype.subscribe=function(e,t,n){return this.on(p(u.RPCCommands.DISPATCH,e),n),this.request(u.RPCCommands.SUBSCRIBE,t,e)},t.prototype.unsubscribe=function(e,t,n){return this.removeListener(p(u.RPCCommands.DISPATCH,e),n),this.request(u.RPCCommands.UNSUBSCRIBE,t,e)},t.prototype.request=function(e,t,n){var o=this;return new Promise(function(r,c){if(!o.connected)return o.once("connected",function(){o.removeAllListeners("disconnected"),r(o.request(e,t,n))}),o.once("disconnected",function(){o.removeAllListeners("connected"),c(new Error("disconnected during request"))}),void o.connect();var i=l.default.v4(),u=JSON.stringify({cmd:e,args:t,evt:n,nonce:i});o.once(p(e,i),function(e,t){return null!=e?c(e):r(t)}),v&&v.send(u)})},t.prototype.requestOnce=function(e,t,n){return a.default.post({url:"http://127.0.0.1:"+this.port+"/rpc?v="+u.RPC_VERSION,body:{cmd:e,args:t,evt:n,nonce:l.default.v4()}}).then(function(e){var t=e.body,n=t.evt,o=t.data;if(n===u.RPCEvents.ERROR)throw new s.default(o.code,o.message);return o})},t.prototype.requestRedirect=function(e,t,n){if("Chrome"===c.default.name&&parseInt(c.default.version,10)>=58)return this.requestOnce(e,t,n);var o=encodeURIComponent(JSON.stringify({cmd:e,args:t,evt:n,nonce:l.default.v4()})),r=encodeURIComponent(location.protocol+"//"+location.host+location.pathname+"?done=true");return window.open("http://127.0.0.1:"+this.port+"/rpc?v="+u.RPC_VERSION+"&payload="+o+"&callback="+r,"_self"),new Promise(function(){return null})},o(t,[{key:"port",get:function(){return h}},{key:"connected",get:function(){return null!=v&&v.readyState===WebSocket.OPEN}}]),t}(r.default);t.default=new m,e.exports=t.default},2100:function(e,t,n){"use strict";t.__esModule=!0;var o=function(e){function t(n,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,o));return r.code=n,r.message=o,r.name="RPCError",r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(Error);t.default=o,e.exports=t.default}}]);
//# sourceMappingURL=cd71c8fdd0c4ad6944f4.js.map